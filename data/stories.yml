version: "2.0"

stories:
# TODO: Turn this into rule once SSO Action session start has been done
- story: General - First Time Meeting - Happy Path
  steps:
  - intent: greet
  - action: utter_greet_first_time
  - action: utter_greet_first_time_followup
  - action: first_form
  - active_loop: first_form
  - active_loop: null
  - action: utter_first_time_confirm
  - intent: affirm
  - action: utter_lesson_options


- story: Fraction - Halves
  steps:
  - action: utter_lesson_options
  - intent: lesson_fractions
  - action: utter_fractions_halves_introduction
  - action: fractions_halves_story_form
  - active_loop: fractions_halves_story_form
  - active_loop: null
  - action: utter_fractions_halves_conclusion
  - action: utter_fractions_halves_conclusion_animation
  - action: action_pause
  - action: utter_start_next

- story: Fractions - Halves -> Parts
  steps:
  - action: utter_fractions_halves_conclusion
  - action: utter_fractions_halves_conclusion_animation
  - action: action_pause
  - action: utter_start_next
  - intent: affirm
  - action: fractions_parts_story_form
  - active_loop: fractions_parts_story_form
  - active_loop: null
  - action: utter_fractions_parts_conclusion
  - action: utter_start_next
  - intent: affirm

- story: Fractions - Parts -> Wholes
  steps:
  - action: fractions_parts_story_form
  - active_loop: fractions_parts_story_form
  - active_loop: null
  - action: utter_fractions_parts_conclusion
  - action: utter_start_next
  - intent: affirm
  - action: utter_fractions_wholes_introduction
  - action: utter_fractions_wholes_introduction_hint
  - action: fractions_wholes_story_form
  - active_loop: fractions_wholes_story_form
  - active_loop: null
  - action: utter_fractions_wholes_conclusion
  - action: utter_fractions_wholes_conclusion_1
  - action: utter_fractions_wholes_conclusion_2
  - action: utter_fractions_wholes_conclusion_3

- story: Fractions - Parts -> Wholes 
  steps:
  - action: utter_fractions_parts_conclusion
  - action: utter_start_next
  - intent: affirm
  - action: utter_fractions_wholes_introduction
  - action: utter_fractions_wholes_introduction_hint
  - action: fractions_wholes_story_form
  - active_loop: fractions_wholes_story_form
  - active_loop: null
  - action: utter_fractions_wholes_conclusion
  - action: utter_fractions_wholes_conclusion_1
  - action: utter_fractions_wholes_conclusion_2
  - action: utter_fractions_wholes_conclusion_3

# General conversation functionality
- story: Exit at End of Lesson 
  steps:
  - action: utter_start_next
  - or:
    - intent: deny 
    - intent: stop
  - action: utter_confirm
  - intent: affirm
  - action: utter_end_chat_session
  - action: action_listen

- story: False exit at End of Lesson 
  steps:
  - action: utter_start_next
  - or:
    - intent: deny 
    - intent: stop
  - action: utter_confirm
  - intent: deny
  - action: action_back

- story: Exit mid lesson 
  steps:
  - intent: stop
  - action: utter_confirm
  - intent: affirm 
  - action: utter_end_chat_session
  - action: action_listen
  
- story: False exit mid lesson 
  steps:
  - intent: stop
  - action: utter_confirm
  - intent: deny 
  - action: action_back

